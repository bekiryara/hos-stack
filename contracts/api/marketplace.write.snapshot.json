[
  {
    "method": "POST",
    "path": "/api/v1/listings",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id"],
    "optional_headers": ["Authorization"],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": null,
        "to": "draft",
        "description": "Creates new listing with status 'draft'"
      }
    ],
    "notes": "Create DRAFT listing. Requires X-Active-Tenant-Id header. Creates listing with status 'draft'. No idempotency required (create only, no replay risk)."
  },
  {
    "method": "POST",
    "path": "/api/v1/listings/{id}/publish",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id"],
    "optional_headers": ["Authorization"],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": "draft",
        "to": "published",
        "description": "Publishes listing. Must be in 'draft' status. Updates status to 'published'."
      }
    ],
    "notes": "Publish listing. Requires X-Active-Tenant-Id header. Validates listing is in 'draft' status before transition to 'published'. No idempotency required (state transition is idempotent by design)."
  },
  {
    "method": "POST",
    "path": "/api/v1/listings/{id}/offers",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id", "Idempotency-Key"],
    "optional_headers": ["Authorization"],
    "idempotency_required": true,
    "idempotency_key_header": "Idempotency-Key",
    "state_transitions": [
      {
        "from": null,
        "to": "inactive",
        "description": "Creates new offer with status 'inactive' (default)"
      }
    ],
    "notes": "Create offer for listing. Requires X-Active-Tenant-Id and Idempotency-Key headers. Creates offer with status 'inactive' by default. Idempotency enforced via idempotency_keys table."
  },
  {
    "method": "POST",
    "path": "/api/v1/offers/{id}/activate",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id"],
    "optional_headers": ["Authorization"],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": "inactive",
        "to": "active",
        "description": "Activates offer. Updates status from 'inactive' to 'active'."
      }
    ],
    "notes": "Activate offer. Requires X-Active-Tenant-Id header. Updates offer status to 'active'. No idempotency required (state transition is idempotent by design)."
  },
  {
    "method": "POST",
    "path": "/api/v1/offers/{id}/deactivate",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id"],
    "optional_headers": ["Authorization"],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": "active",
        "to": "inactive",
        "description": "Deactivates offer. Updates status from 'active' to 'inactive'."
      }
    ],
    "notes": "Deactivate offer. Requires X-Active-Tenant-Id header. Updates offer status to 'inactive'. No idempotency required (state transition is idempotent by design)."
  },
  {
    "method": "POST",
    "path": "/api/v1/reservations",
    "owner": "marketplace",
    "scope": "personal",
    "required_headers": ["Authorization", "Idempotency-Key"],
    "optional_headers": [],
    "idempotency_required": true,
    "idempotency_key_header": "Idempotency-Key",
    "state_transitions": [
      {
        "from": null,
        "to": "requested",
        "description": "Creates new reservation with status 'requested'"
      }
    ],
    "notes": "Create reservation. Requires Authorization (via auth.ctx middleware) and Idempotency-Key headers. Creates reservation with status 'requested'. Idempotency enforced via idempotency_keys table."
  },
  {
    "method": "POST",
    "path": "/api/v1/reservations/{id}/accept",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id", "Authorization"],
    "optional_headers": [],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": "requested",
        "to": "accepted",
        "description": "Accepts reservation. Must be in 'requested' status. Updates status to 'accepted'."
      }
    ],
    "notes": "Accept reservation. Requires X-Active-Tenant-Id and Authorization (via auth.ctx middleware) headers. Validates reservation is in 'requested' status before transition to 'accepted'. No idempotency required (state transition is idempotent by design - atomic update with WHERE status='requested')."
  },
  {
    "method": "POST",
    "path": "/api/v1/orders",
    "owner": "marketplace",
    "scope": "personal",
    "required_headers": ["Authorization", "Idempotency-Key"],
    "optional_headers": [],
    "idempotency_required": true,
    "idempotency_key_header": "Idempotency-Key",
    "state_transitions": [
      {
        "from": null,
        "to": "placed",
        "description": "Creates new order with status 'placed'"
      }
    ],
    "notes": "Create order. Requires Authorization (via auth.ctx middleware) and Idempotency-Key headers. Creates order with status 'placed'. Idempotency enforced via idempotency_keys table."
  },
  {
    "method": "POST",
    "path": "/api/v1/rentals",
    "owner": "marketplace",
    "scope": "personal",
    "required_headers": ["Authorization", "Idempotency-Key"],
    "optional_headers": [],
    "idempotency_required": true,
    "idempotency_key_header": "Idempotency-Key",
    "state_transitions": [
      {
        "from": null,
        "to": "requested",
        "description": "Creates new rental with status 'requested'"
      }
    ],
    "notes": "Create rental. Requires Authorization (via auth.ctx middleware) and Idempotency-Key headers. Creates rental with status 'requested'. Idempotency enforced via idempotency_keys table."
  },
  {
    "method": "POST",
    "path": "/api/v1/rentals/{id}/accept",
    "owner": "marketplace",
    "scope": "store",
    "required_headers": ["X-Active-Tenant-Id", "Authorization"],
    "optional_headers": [],
    "idempotency_required": false,
    "idempotency_key_header": null,
    "state_transitions": [
      {
        "from": "requested",
        "to": "accepted",
        "description": "Accepts rental. Must be in 'requested' status. Updates status to 'accepted'."
      }
    ],
    "notes": "Accept rental. Requires X-Active-Tenant-Id and Authorization (via auth.ctx middleware) headers. Validates rental is in 'requested' status before transition to 'accepted'. No idempotency required (state transition is idempotent by design - atomic update with WHERE status='requested')."
  }
]

